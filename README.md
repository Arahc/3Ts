# README

### Developers

> 陈籽安 
>
> 戚桐瑜 2024591032
>
> 何宗原 





### Gameplay

#### 战斗规则

省流规则：

1. 你有一堆门，门有非且或与非或非异或同或七种，门还分 01 两种属性，门还有数值，对面有一个 01 属性串，每个 0/1 也带一个数值。
2. 你可以用门去修改对面的 01 串，也可以抽卡。这两个都可以任意进行，但是消耗精力，每回合回复一定量精力。
3. 回合结束时把你和对面属性 0 的数值加起来拼点，1 的也是。分别计算伤害，大的对小的造成插值的伤害。

---

![](https://pic1.imgdb.cn/item/67821599d0e0a243d4f355b3.png)

在屏幕左下角的，是我方的卡；在屏幕右下角则是敌方的卡。

鼠标移动到卡上，可以查看这张卡的信息。

+ 名称：一般的卡都有很帅的名称，除非你没那么帅。
+ 门类：共七种，边框颜色为 $\text{{\color{red}红}、{\color{orange}橙}、{\color{gold}黄}、{\color{green}绿}、{\color{lightblue}蓝}、{\color{blue}靛}、{\color{purple}紫}}$ 的技能，门类分别为 $\text{{\color{red}not}、{\color{orange}and}、{\color{gold}or}、{\color{green}nand}、{\color{lightblue}nor}、{\color{blue}xor}、{\color{purple}xnor}}$。此外还有一种 $\text{{\color{brown}棕}}$ 色边框的卡，没有门类，也就是 $\text{{\color{brown}无类}}$。
+ 类型：共两种，阴（0）和阳（1）。
+ 等级：卡牌的等级，这是最重要也是最直接的数值。只要这个高，无视以上任何一条直接碾过去就行了。

每个回合，你都可以选择自己的卡（单击选中），然后选择对方的一或两张卡，进行一次操作。

操作的方式是：

1. 若你选择的是 $\text{{\color{red}非门}}$，则你只能选中对方的一张卡，将其类型反转。
2. 否则，你选中对方的两张卡，将其合并为一张卡，你的卡的门类决定了得到的卡的类型，这与电路上的与门、或门……等等规则相同。得到的卡的等级是对方两张卡等级的较大值。

无论你使用何种门，每次使用消耗 1 精力。

Draw 按钮用来消耗 1 精力抽卡。

Undo 按钮撤销你本回合所有操作。

顶上那个亮亮的按钮摁一下结束你的回合（也可以拍空格）。然后开始计算伤害。

对于阳和阴，分别计算伤害，若你手上的阳卡等级和为 $X$，对面的等级和为 $Y$，则高的对低的造成 $|X-Y|$ 点伤害。阴属性同理。

当我方生命值归零时，失败。

当我方生命值未归零且所有敌人生命值归零，胜利。

## 程序方面

### 文件结构

```
|- assets
|    |- card // 卡图
|    |- char // 人物（含友方和敌方）图
|    |- font // 字体
|    |- img // 其他图片（背景图、按钮……）
|
|- save
|    |- friends.json // 玩家的数值、卡组信息
|    |- level0 // 关卡 0 的信息（背景、敌人……）
|    |- level1 // 关卡 1
|    |- ...
|
|- Animation.py // 动画类，用于实现简单动画
|- battleController.py // 主程序，运行此程序的 main 函数开启战斗
|- Card.py // 卡牌类
|- Character.py // 角色类
|- Clash.py // 拼点的实现
|- Img.py // 图片类，结合动画类食用
|- mouseSelect.py // 检查鼠标操作
|- saveSet.py // 从 assets 和 save 中读取存档等文件
|- screenPainter.py // 将每一帧的图像绘制到屏幕上
```

### 实现逻辑

+ **动画实现**：通过 `Animations` 记录当前未完成的动画，每一帧更新所有未完成的动画。动画是否完成也作为游戏重要时刻指标存在。例如使用拼点动画结束这个事件来恢复正常游戏操作（拼点时，下回合、撤销等按钮不相应）。
  + 使用自造的 `Img` （`Surface`+手动存大小+手动存位置+手动存透明度）来弥补 `Surface` 我不怎么会用的问题。
+ **画画**：血量、精力、剩余敌人数均以计量条的形式实现。除了拼点时才会发生的现实双方拼点信息，其他内容均在 `screenPainter.py` 中实现。
+ **基本信息**：使用 `gSet`（即 global set）存储重要的全局变量。在主程序开始使用 mainInit 进行初始化。注意：角色信息等存储在 json 文件中，并没有存在 mainInit 里。